<!-- Backdrop styles come from global styles. Backdrop causes the form to be displayed on top of other components -->
<div class="backdrop" (click)="changeVisibility()">
	<div class="bg" (click)="$event.stopPropagation()">
		<div class="glassbox">
			<!-- Button to close the edit-window -->
			<div class="close-button" (click)="changeVisibility()">
				<img
					class="close-icon"
					src="assets\icons\close.svg"
					alt="close-button"
				/>
			</div>

			<h2>Rekisteröidy palvelun käyttäjäksi</h2>
			<div class="container" *ngIf="!confirmForm">
				<div class="leftContent">
					<form #f="ngForm" (click)="$event.stopPropagation()">
						<!-- Input for email -->
						<label>
							Sähköposti *
							<input
								type="text"
								required
								minlength="2"
								maxlength="45"
								name="email"
								[(ngModel)]="email"
							/>
						</label>

						<!-- Input for password -->
						<label>
							Salasana *
							<input
								[ngClass]="{errorinput: pwError}"
								type="password"
								required
								minlength="2"
								maxlength="45"
								name="password"
								[(ngModel)]="password"
							/>
						</label>

						<p class="error" *ngIf="pwError">
							Salasanat eivät vastaa toisiaan
						</p>

						<!-- Input for password confirmation -->
						<label>
							Salasana uudelleen *
							<input
								[ngClass]="{errorinput: pwError}"
								type="password"
								required
								minlength="2"
								maxlength="45"
								name="passwordconfirm"
								[(ngModel)]="passwordconfirm"
							/>
						</label>
						<p class="error" *ngIf="pwError">
							Salasanat eivät vastaa toisiaan
						</p>
					</form>
				</div>
				<div class="rightContent">
					<p class="help">
						Syötä ammattikorkeakoulusi opiskelija- sähköpostiosoite,
						johon lähetämme vahvistuskoodin.
					</p>

					<p class="linktext" (click)="confirmForm = !confirmForm">
						Vahvista jo luotu tili tästä.
					</p>

					<label class="radiolabel">
						<input
							type="checkbox"
							[checked]="acceptTerms"
							(change)="acceptTerms = !acceptTerms"
							required
						/>
						Hyväksyn <a class="linktext">käyttöehdot</a>
					</label>

					<div>
						<p *ngIf="registerError" class="error">
							Virhe rekisteröinnissä.
						</p>

						<div class="btnandtxt">
							<button
								[disabled]="!f.valid || !acceptTerms"
								(click)="onSubmit(f.value)"
								type="submit"
								class="greenbutton"
							>
								Rekisteröidy
							</button>
							<div>
								<p class="linktext" (click)="showLogin()">
									Onko sinulla jo tili?<br />
									Kirjaudu sisään tästä
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="confirmcontainer" *ngIf="confirmForm">
				<p class="help">
					Syötä 6-numeroinen koodi, jonka lähetimme sinulle
					sähköpostiisi.
				</p>
				<form
					#confirmForm="ngForm"
					class="confirmForm"
					(click)="$event.stopPropagation()"
				>
					<!-- Input for email -->
					<label>
						Sähköposti *
						<input
							type="text"
							required
							minlength="2"
							maxlength="45"
							name="emailToConfirm"
							[(ngModel)]="emailToConfirm"
						/>
					</label>

					<!-- Input for code -->
					<label>
						Koodi *
						<input
							type="text"
							required
							minlength="6"
							maxlength="6"
							name="code"
							[(ngModel)]="code"
						/>
					</label>
				</form>

				<div>
					<p *ngIf="confirmError" class="error">
						Virhe käyttäjätilin vahvistamisessa.
					</p>

					<div class="btnandtxt">
						<button
							[disabled]="!confirmForm.valid"
							(click)="confirmAccount(confirmForm.value)"
							type="submit"
							class="greenbutton"
						>
							Vahvista käyttäjä
						</button>
						<div>
							<p class="linktext" (click)="resendCode()">
								Etkö saanut koodia?<br />
								Tarkista roskapostikansio tai tilaa uusi koodi
								tästä.
							</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
